---
title: "student-success-analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(rlang)
library(tidyverse)
message("Your current working directory is: ", getwd())
```


## Data loading and getting the feeling of the dataset

```{r}
students_org <- readxl::read_excel("student_data.xlsx")

# 370 rows, 39 columns
dim(students_org)

# Show column names
names(students_org)
```
```{r}
# Show first few rows
head(students_org)
```


```{r}
# Show details for each column
summary(students_org)
```


```{r}
# Check the class of the column. "numeric", "character"...
sapply(students_org,class)
```

```{r}

# Let's check if any columns exceed the maximum or minumum values specified in the pdf
# This makes sense only for numerical values

colMax <- students_org %>% select(where(is.numeric)) %>% sapply(., max, na.rm = TRUE)
colMax

# Every column has normal maximum value
```




```{r}
# Are there any na values?
students_org %>% filter(is.na(.))
sum(apply(students_org,2,is.nan))
students_org %>% filter(is.null(.))

# Drop these values just in case they show up with another dataset
# We will continue using "student" variable
students <- students_org %>% filter_all(all_vars(!is.na(.) & !is.nan(.) & !is.null(.)))
```

1. Jesu li učenici uspješniji u matematici ili glavnom jeziku?

```{r}

students_org  %>% summarise(
          Mean.G1_mat = mean(G1_mat),
          Mean.G2_mat = mean(G2_mat),
          Mean.G3_mat = mean(G3_mat),
          Mean.G1_por = mean(G1_por),
          Mean.G2_por = mean(G2_por),
          Mean.G3_por = mean(G3_por),
            ) -> summary.result1
summary.result1

students_org  %>% summarise(
          Med.G1_mat = median(G1_mat),
          Med.G2_mat = median(G2_mat),
          Med.G3_mat = median(G3_mat),
          Med.G1_por = median(G1_por),
          Med.G2_por = median(G2_por),
          Med.G3_por = median(G3_por),
            ) -> summary.result2
summary.result2

students_org  %>% summarise(
          Mean.G1_mat = mean(G1_mat, trim = 0.1),
          Mean.G2_mat = mean(G2_mat, trim = 0.1),
          Mean.G3_mat = mean(G3_mat, trim = 0.1),
          Mean.G1_por = mean(G1_por, trim = 0.1),
          Mean.G2_por = mean(G2_por, trim = 0.1),
          Mean.G3_por = mean(G3_por, trim = 0.1),
            ) -> summary.result3
summary.result3

(1 - summary.result3/summary.result1)*100

```

Kao što je vidljivo iz podataka, učenici su malo uspješniji u glavnom jeziku (portugalskom), ali ako gleda prema samoj ocjeni obje skupine spadaju u ocjenu "C". Čak i ako uzmemo podrezanu srednju vrijednost (10%), rezultat se promijeni za ~1%.


```{r}

students_org  %>% summarise(
          IQR.G1_mat = IQR(G1_mat),
          IQR.G2_mat = IQR(G2_mat),
          IQR.G3_mat = IQR(G3_mat),
          IQR.G1_por = IQR(G1_por),
          IQR.G2_por = IQR(G2_por),
          IQR.G3_por = IQR(G3_por),
            ) -> summary.result4
summary.result4

students_org  %>% summarise(
          Var.G1_mat = var(G1_mat),
          Var.G2_mat = var(G2_mat),
          Var.G3_mat = var(G3_mat),
          Var.G1_por = var(G1_por),
          Var.G2_por = var(G2_por),
          Var.G3_por = var(G3_por),
            ) -> summary.result5
summary.result5


students_org  %>% summarise(
          sd.G1_mat = sd(G1_mat),
          sd.G2_mat = sd(G2_mat),
          sd.G3_mat = sd(G3_mat),
          sd.G1_por = sd(G1_por),
          sd.G2_por = sd(G2_por),
          sd.G3_por = sd(G3_por),
            ) -> summary.result6
summary.result6

```

Ako gledamo raspršenost varijabli vidimo da ocjene iz portugalskog jezika imaju manje sve tri mjere (IQR, varijanca i standardna devijacija) vidimo da se ocjene iz portugalskog manje manje odmiču od srednje vrijednosti nego ocjene iz matematike.
